var m=class extends Error{constructor(t){super(t),this.name="APIError"}},p=class extends m{constructor(t){super(t),this.name="LoginError"}},_=class extends Error{constructor(t){super(t),this.name="SessionError"}},l=class extends _{constructor(t){super(t),this.name="SessionExpired"}},g=class extends _{constructor(t){super(t),this.name="NotLoggedIn"}},y=class extends Error{constructor(t){super(t),this.name="AccountAPIError"}};var j=class n{constructor(t,e,s,i,r,c,d,o,u,D,A){this.employee_name=t,this.employee_code=e,this.minor_subject=s,this.remarks=i,this.stytype=r,this.credits=c,this.subject_code=d,this.subject_component_code=o,this.subject_desc=u,this.subject_id=D,this.audtsubject=A}static from_json(t){return new n(t.employeename,t.employeecode,t.minorsubject,t.remarks,t.stytype,t.credits,t.subjectcode,t.subjectcomponentcode,t.subjectdesc,t.subjectid,t.audtsubject)}},w=class{constructor(t){this.raw_response=t,this.total_credits=t.totalcreditpoints,this.subjects=t.registrations.map(j.from_json)}};var S=class n{constructor(t,e,s,i){this.branchdesc=t,this.name=e,this.programdesc=s,this.stynumber=i}static from_json(t){return new n(t.branchdesc,t.name,t.programdesc,t.stynumber)}},h=class n{constructor(t,e){this.registration_code=t,this.registration_id=e}static from_json(t){return new n(t.registrationcode,t.registrationid)}},f=class{constructor(t){this.raw_response=t,this.headers=t.headerlist.map(S.from_json),this.semesters=t.semlist.map(h.from_json)}latest_header(){return this.headers[0]}latest_semester(){return this.semesters[0]}};var b=class n{constructor(t,e,s,i,r){this.exam_event_code=t,this.event_from=e,this.exam_event_desc=s,this.registration_id=i,this.exam_event_id=r}static from_json(t){return new n(t.exameventcode,t.eventfrom,t.exameventdesc,t.registrationid,t.exameventid)}};function E(n=null){n===null&&(n=new Date);let t=String(n.getDate()).padStart(2,"0"),e=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getFullYear()).slice(2),i=String(n.getDay());return t[0]+e[0]+s[0]+i+t[1]+e[1]+s[1]}function O(n){let t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e="";for(let s=0;s<n;s++){let i=Math.floor(Math.random()*t.length);e+=t[i]}return e}function k(n){return btoa(String.fromCharCode.apply(null,new Uint8Array(n)))}var C=new TextEncoder().encode("dcek9wb8frty1pnm");async function L(n=null){let t=E(n),e=new TextEncoder().encode("qa8y"+t+"ty1pn");return window.crypto.subtle.importKey("raw",e,{name:"AES-CBC"},!1,["encrypt","decrypt"])}async function T(n=null){let t=O(4),e=E(n),s=O(5),i=new TextEncoder().encode(t+e+s),r=await I(i);return k(r)}async function I(n){let t=await L(),e=await window.crypto.subtle.encrypt({name:"AES-CBC",iv:C},t,n);return new Uint8Array(e)}async function N(n){let t=new TextEncoder().encode(JSON.stringify(n)),e=await I(t);return k(e)}var a="https://webportal.jiit.ac.in:6011/StudentPortalAPI",v={captcha:"phw5n",hidden:"gmBctEffdSg="},P=class{constructor(t){this.raw_response=t,this.regdata=t.regdata;let e=this.regdata.institutelist[0];this.institute=e.label,this.instituteid=e.value,this.memberid=this.regdata.memberid,this.userid=this.regdata.userid,this.token=this.regdata.token;let s=JSON.parse(atob(this.token.split(".")[1])).exp;this.expiry=new Date(s*1e3),this.clientid=this.regdata.clientid,this.membertype=this.regdata.membertype,this.name=this.regdata.name,this.enrollmentno=this.regdata.enrollmentno}async get_headers(){let t=await T();return{Authorization:`Bearer ${this.token}`,LocalName:t}}},x=class{constructor(){this.session=null}async __hit(t,e,s={}){let i=m;s.exception&&(i=s.exception,delete s.exception);let r;s.authenticated?(r=await this.session.get_headers(),delete s.authenticated):r={LocalName:await T()},s.headers?s.headers={...s.headers,...r}:s.headers=r;let c={method:t,headers:{"Content-Type":"application/json",...s.headers}};s.json?c.body=JSON.stringify(s.json):c.body=s.body;try{console.log("fetching",e,"with options",c);let d=await fetch(e,c);if(d.status===513)throw new i("JIIT Web Portal server is temporarily unavailable (HTTP 513). Please try again later.");if(d.status===401)throw new l(d.error);let o=await d.json();if(o.status&&o.status.responseStatus!=="Success")throw new i(`status:
${JSON.stringify(o.status,null,2)}`);return o}catch(d){throw d instanceof TypeError&&d.message.includes("CORS")?new i("JIIT Web Portal server is temporarily unavailable. Please try again later."):new i(d.message||"Unknown error")}}async student_login(t,e,s=v){let i="/token/pretoken-check",r="/token/generate-token1",c={username:t,usertype:"S",captcha:s};c=await N(c);let o=(await this.__hit("POST",a+i,{body:c,exception:p})).response;delete o.rejectedData,o.Modulename="STUDENTMODULE",o.passwordotpvalue=e,o=await N(o);let u=await this.__hit("POST",a+r,{body:o,exception:p});return this.session=new P(u.response),this.session}async get_personal_info(){let t="/studentpersinfo/getstudent-personalinformation",e={clinetid:"SOAU",instituteid:this.session.instituteid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response}async get_student_bank_info(){let t="/studentbankdetails/getstudentbankinfo",e={instituteid:this.session.instituteid,studentid:this.session.memberid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response}async change_password(t,e){let s="/clxuser/changepassword",i={membertype:this.session.membertype,oldpassword:t,newpassword:e,confirmpassword:e};return(await this.__hit("POST",a+s,{json:i,authenticated:!0,exception:y})).response}async get_attendance_meta(){let t="/StudentClassAttendance/getstudentInforegistrationforattendence",e={clientid:this.session.clientid,instituteid:this.session.instituteid,membertype:this.session.membertype},s=await this.__hit("POST",a+t,{json:e,authenticated:!0});return new f(s.response)}async get_attendance(t,e){let s="/StudentClassAttendance/getstudentattendancedetail",i={clientid:this.session.clientid,instituteid:this.session.instituteid,registrationcode:e.registration_code,registrationid:e.registration_id,stynumber:t.stynumber};return(await this.__hit("POST",a+s,{json:i,authenticated:!0})).response}async get_subject_daily_attendance(t,e,s,i){let r="/StudentClassAttendance/getstudentsubjectpersentage",c={cmpidkey:i.map(o=>({subjectcomponentid:o})),clientid:this.session.clientid,instituteid:this.session.instituteid,registrationcode:t.registration_code,registrationid:t.registration_id,subjectcode:s,subjectid:e};return(await this.__hit("POST",a+r,{json:c,authenticated:!0})).response}async get_registered_semesters(){let t="/reqsubfaculty/getregistrationList",e={instituteid:this.session.instituteid,studentid:this.session.memberid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response.registrations.map(i=>h.from_json(i))}async get_registered_subjects_and_faculties(t){let e="/reqsubfaculty/getfaculties",s={instituteid:this.session.instituteid,studentid:this.session.memberid,registrationid:t.registration_id},i=await this.__hit("POST",a+e,{json:s,authenticated:!0});return new w(i.response)}async get_semesters_for_exam_events(){let t="/studentcommonsontroller/getsemestercode-withstudentexamevents",e={clientid:this.session.clientid,instituteid:this.session.instituteid,memberid:this.session.memberid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response.semesterCodeinfo.semestercode.map(i=>h.from_json(i))}async get_exam_events(t){let e="/studentcommonsontroller/getstudentexamevents",s={instituteid:this.session.instituteid,registationid:t.registration_id};return(await this.__hit("POST",a+e,{json:s,authenticated:!0})).response.eventcode.examevent.map(r=>b.from_json(r))}async get_exam_schedule(t){let e="/studentsttattview/getstudent-examschedule",s={instituteid:this.session.instituteid,registrationid:t.registration_id,exameventid:t.exam_event_id};return(await this.__hit("POST",a+e,{json:s,authenticated:!0})).response}async get_semesters_for_marks(){let t="/studentcommonsontroller/getsemestercode-exammarks",e={instituteid:this.session.instituteid,studentid:this.session.memberid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response.semestercode.map(i=>h.from_json(i))}async download_marks(t){let e="/studentsexamview/printstudent-exammarks/"+this.session.memberid+"/"+this.session.instituteid+"/"+t.registration_id+"/"+t.registration_code,s=await T(),r={method:"GET",headers:await this.session.get_headers(s)};try{let d=await(await fetch(a+e,r)).blob(),o=window.URL.createObjectURL(d),u=document.createElement("a");u.href=o,u.download=`marks_${t.registration_code}.pdf`,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(o),u.remove()}catch(c){throw new m(c)}}async get_semesters_for_grade_card(){let t="/studentgradecard/getregistrationList",e={instituteid:this.session.instituteid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response.registrations.map(i=>h.from_json(i))}async __get_program_id(){let t="/studentgradecard/getstudentinfo",e={instituteid:this.session.instituteid};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response.programid}async get_grade_card(t){let e=await this.__get_program_id(),s="/studentgradecard/showstudentgradecard",i={branchid:this.session.branch_id,instituteid:this.session.instituteid,programid:e,registrationid:t.registration_id};return(await this.__hit("POST",a+s,{json:i,authenticated:!0})).response}async __get_semester_number(){let t="/studentsgpacgpa/checkIfstudentmasterexist",e={instituteid:this.session.instituteid,studentid:this.session.memberid,name:this.session.name,enrollmentno:this.session.enrollmentno};return(await this.__hit("POST",a+t,{json:e,authenticated:!0})).response.studentlov.currentsemester}async get_sgpa_cgpa(){let t="/studentsgpacgpa/getallsemesterdata",e=await this.__get_semester_number(),s={instituteid:this.session.instituteid,studentid:this.session.memberid,stynumber:e};return(await this.__hit("POST",a+t,{json:s,authenticated:!0})).response}};function U(n){return function(...t){if(this.session==null)throw new g;return n.apply(this,t)}}var q=["get_personal_info","get_student_bank_info","change_password","get_attendance_meta","get_attendance","get_subject_daily_attendance","get_registered_semesters","get_registered_subjects_and_faculties","get_semesters_for_exam_events","get_exam_events","get_exam_schedule","get_semesters_for_marks","download_marks","get_semesters_for_grade_card","__get_program_id","get_grade_card","__get_semester_number","get_sgpa_cgpa"];q.forEach(n=>{x.prototype[n]=U(x.prototype[n])});export{a as API,m as APIError,y as AccountAPIError,S as AttendanceHeader,f as AttendanceMeta,v as DEFCAPTCHA,b as ExamEvent,p as LoginError,g as NotLoggedIn,j as RegisteredSubject,w as Registrations,h as Semester,_ as SessionError,l as SessionExpired,x as WebPortal,P as WebPortalSession};
//# sourceMappingURL=jsjiit.min.esm.js.map
